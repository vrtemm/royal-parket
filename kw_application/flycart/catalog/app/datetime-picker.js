angular.module("ui.bootstrap.datetimepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("uiDatetimePickerConfig",{dateFormat:"yyyy-MM-dd HH:mm",enableDate:!0,enableTime:!0,todayText:"Today",nowText:"Now",closeText:"Done",dateText:"Date",timeText:"Time",closeOnDateSelection:!0,appendToBody:!1,showButtonBar:!0}).directive("datetimePicker",["$compile","$parse","$document","$timeout","$position","dateFilter","dateParser","uiDatetimePickerConfig",function(e,t,n,a,i,o,s,d){return{restrict:"A",require:"ngModel",scope:{isOpen:"=?",enableDate:"=?",enableTime:"=?",todayText:"@",nowText:"@",dateText:"@",timeText:"@",clearText:"@",closeText:"@",dateDisabled:"&"},link:function(a,r,l,c){function u(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}function p(e){return l.dateDisabled&&angular.isDefined(e)&&a.dateDisabled({date:e,mode:a.watchData.datepickerMode})}function m(e){if(e){if(angular.isDate(e)&&!isNaN(e))return c.$setValidity("date",!0),e;if(angular.isString(e)){var t=s.parse(e,f)||new Date(e);return isNaN(t)?void c.$setValidity("date",!1):(c.$setValidity("date",!0),t)}return void c.$setValidity("date",!1)}return c.$setValidity("date",!0),null}var g,f=d.dateFormat,b=angular.isDefined(l.closeOnDateSelection)?a.$parent.$eval(l.closeOnDateSelection):d.closeOnDateSelection,w=angular.isDefined(l.datepickerAppendToBody)?a.$parent.$eval(l.datepickerAppendToBody):d.appendToBody;a.showButtonBar=angular.isDefined(l.showButtonBar)?a.$parent.$eval(l.showButtonBar):d.showButtonBar,a.enableDate=angular.isDefined(a.enableDate)?a.enableDate:d.enableDate,a.enableTime=angular.isDefined(a.enableTime)?a.enableTime:d.enableTime,a.showPicker=a.enableDate?"date":"time",a.todayText=a.todayText||"Today",a.nowText=a.nowText||"Now",a.closeText=a.closeText||"Close",a.dateText=a.dateText||"Date",a.timeText=a.timeText||"Time",a.getText=function(e){return a[e+"Text"]||d[e+"Text"]},l.$observe("datetimePicker",function(e){f=e||d.dateFormat,c.$render()});var k=angular.element('<div date-picker-wrap ng-show="showPicker == \'date\'"><div datepicker></div></div><div time-picker-wrap ng-show="showPicker == \'time\'"><div timepicker style="margin:0 auto"></div></div>');k.attr({"ng-model":"date","ng-change":"dateSelection()"});var D=angular.element(k.children()[0]);l.datepickerOptions&&angular.forEach(a.$parent.$eval(l.datepickerOptions),function(e,t){D.attr(u(t),e)});var h=angular.element(k.children()[1]);l.timepickerOptions&&angular.forEach(a.$parent.$eval(l.timepickerOptions),function(e,t){h.attr(u(t),e)}),l.datepickerMode||(l.datepickerMode="day"),a.watchData={},angular.forEach(["minDate","maxDate","datepickerMode"],function(e){if(l[e]){var n=t(l[e]);if(a.$parent.$watch(n,function(t){a.watchData[e]=t}),D.attr(u(e),"watchData."+e),"datepickerMode"===e){var i=n.assign;a.$watch("watchData."+e,function(e,t){e!==t&&i(a.$parent,e)})}}}),l.dateDisabled&&D.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),a.dateSelection=function(e){a.enableDate&&a.enableTime&&"time"===a.showPicker&&g&&null!==g&&(null!==a.date||e||null!=e)&&(e&&null!=e?(g.setHours(e.getHours()),g.setMinutes(e.getMinutes()),g.setSeconds(e.getSeconds()),g.setMilliseconds(e.getMilliseconds()),e=new Date(g)):(g.setHours(a.date.getHours()),g.setMinutes(a.date.getMinutes()),g.setSeconds(a.date.getSeconds()),g.setMilliseconds(a.date.getMilliseconds()))),angular.isDefined(e)&&(a.date=e),g=a.date,c.$setViewValue(o(a.date,f)),c.$render(),b&&"time"!=a.showPicker&&(a.enableTime?a.showPicker="time":(a.isOpen=!1,r[0].focus()))},r.bind("input change keyup",function(){a.$apply(function(){a.date=c.$modelValue})}),c.$render=function(){var e=c.$viewValue?m(c.$viewValue):null,t=e?o(e,f):"";r.val(t),a.date=e};var y=function(e){a.isOpen&&e.target!==r[0]&&a.$apply(function(){a.isOpen=!1})},T=function(e,t){a.keydown(e)};r.bind("keydown",T),a.keydown=function(e){27===e.which?(e.preventDefault(),a.isOpen&&e.stopPropagation(),a.close()):40!==e.which||a.isOpen||(a.isOpen=!0)},a.$watch("isOpen",function(e){e?(a.$broadcast("datepicker.focus"),a.position=w?i.offset(r):i.position(r),a.position.top=a.position.top+r.prop("offsetHeight"),n.bind("mousedown",y)):n.unbind("mousedown",y)}),a.isTodayDisabled=function(){return p(new Date)},a.select=function(e){if("today"===e||"now"==e){var t=new Date;angular.isDate(c.$modelValue)?(e=new Date(c.$modelValue),e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())):e=t}a.dateSelection(e)},a.close=function(){a.isOpen=!1,r[0].focus()},a.changePicker=function(e){a.showPicker=e};var $=e(k)(a);k.remove(),w?n.find("body").append($):r.after($),a.$on("$destroy",function(){$.remove(),r.unbind("keydown",T),n.unbind("mousedown",y)})}}}]).directive("datePickerWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datetime-picker.html",link:function(e,t,n){t.bind("mousedown",function(e){e.preventDefault(),e.stopPropagation()})}}}).directive("timePickerWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datetime-picker.html",link:function(e,t,n){t.bind("mousedown",function(e){e.preventDefault(),e.stopPropagation()})}}}),angular.module("ui.bootstrap.datetimepicker").run(["$templateCache",function(e){"use strict";e.put("template/datetime-picker.html",'<ul class="dropdown-menu dropdown-menu-left" ng-style="{display: (isOpen && \'block\') || \'none\', top: position.top+\'px\', left: position.left+\'px\'}" style=left:inherit ng-keydown=keydown($event)><li style="padding:0 5px 5px 5px" class=datetime-picker><div ng-transclude></div></li><li ng-if=showButtonBar style=padding:5px><span class="btn-group pull-left" style=margin-right:10px><button ng-if="showPicker == \'date\'" type=button class="btn btn-sm btn-info" ng-click="select(\'today\')" ng-disabled=isTodayDisabled()>{{ getText(\'today\') }}</button> <button ng-if="showPicker == \'time\'" type=button class="btn btn-sm btn-info" ng-click="select(\'now\')" ng-disabled=isTodayDisabled()>{{ getText(\'now\') }}</button></span> <span class="btn-group pull-right"><button ng-if="showPicker == \'date\' && enableTime" type=button class="btn btn-sm btn-default" ng-click="changePicker(\'time\')">{{ getText(\'time\')}}</button> <button ng-if="showPicker == \'time\' && enableDate" type=button class="btn btn-sm btn-default" ng-click="changePicker(\'date\')">{{ getText(\'date\')}}</button> <button type=button class="btn btn-sm btn-success" ng-click=close()>{{ getText(\'close\') }}</button></span></li></ul>')}]);